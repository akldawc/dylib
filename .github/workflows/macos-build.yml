name: Build dylib on macOS

on:
  push:
    branches:
      - main  # 只有推送到 main 分支时才触发

jobs:
  build:
    runs-on: macos-latest  # 使用 macOS 环境进行构建

    steps:
      - name: Checkout code
        uses: actions/checkout@v2  # 拉取仓库代码

      - name: Install Xcode Command Line Tools
        run: |
          sudo xcode-select --install  # 安装 Xcode 命令行工具（通常 macOS 环境已预安装，但加个步骤确保）
      
      - name: Build dylib
        run: |
          clang -dynamiclib -o libmylibrary.dylib mylibrary.c  # 使用 clang 编译 C 代码生成 dylib 文件
          ls -lh libmylibrary.dylib  # 列出生成的 dylib 文件